
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data Processing with Ray Data &#8212; Course Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_hide.css?v=af9667c8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'courses/WL_Ray_Data_Processing/02_Ray_Data_data_processing';</script>
    <script src="../../_static/custom_toggle.js?v=1235ef5b"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Course Notebooks</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Ray Enablement Content
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Intro to Ray</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00_Intro_Ray_Core_Basics_01.html">Introduction to Ray Core: Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00_Intro_Ray_Core_Basics_02.html">0. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00_Intro_Ray_Core_Basics_03.html">1. Creating Remote Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00_Intro_Ray_Core_Basics_04.html">2. Executing Remote Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00_Intro_Ray_Core_Basics_05.html">4. Putting It All Together</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_01.html">Introduction to Ray Core (Advancement): Object store, Tasks, Actors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_02.html">1. Object store</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_03.html">2. Chaining Tasks and Passing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_04.html">3. Task retries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_05.html">4. Task Runtime Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_06.html">5. Resource allocation and management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_07.html">6. Nested Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_08.html">7. Pattern: Pipeline data processing and waiting for results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/00a_Intro_Ray_Core_Advancement_09.html">8. Ray Actors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/01_Intro_Ray_AI_Libs_Overview_01.html">Introduction to the Ray AI Libraries: An example of using Ray data, Ray Train, Ray Tune, Ray Serve to implement a XGBoost regression model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/01_Intro_Ray_AI_Libs_Overview_02.html">1. Overview of the Ray AI Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/01_Intro_Ray_AI_Libs_Overview_03.html">2. Quick end-to-end example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02a_Intro_Ray_Train_with_PyTorch_01.html">Introduction to Ray Train + PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02a_Intro_Ray_Train_with_PyTorch_02.html">1. When to use Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02a_Intro_Ray_Train_with_PyTorch_03.html">2. Single GPU Training with PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02a_Intro_Ray_Train_with_PyTorch_04.html">3. Distributed Data Parallel Training with Ray Train and PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02b_Intro_Ray_Train_with_PyTorch_Lightning_01.html">Introduction to Ray Train: Ray Train + PyTorch Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02b_Intro_Ray_Train_with_PyTorch_Lightning_02.html">1. When to use Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02b_Intro_Ray_Train_with_PyTorch_Lightning_03.html">2. Single GPU Training with PyTorch Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02b_Intro_Ray_Train_with_PyTorch_Lightning_04.html">3. Distributed Training with Ray Train and PyTorch Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/02b_Intro_Ray_Train_with_PyTorch_Lightning_05.html">4. Ray Train in Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/03_Intro_Ray_Tune_01.html">Introduction to Ray Tune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/03_Intro_Ray_Tune_02.html">1. Loading the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/03_Intro_Ray_Tune_03.html">2. Starting out with vanilla PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/03_Intro_Ray_Tune_04.html">3. Hyperparameter tuning with Ray Tune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/03_Intro_Ray_Tune_05.html">4. Ray Tune in Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04a_Intro_Ray_Data_Industry_Landscape_01.html">Introduction to Ray Data: Industry Landscape</a></li>

<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04a_Intro_Ray_Data_Industry_Landscape_02.html">The Compute Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04a_Intro_Ray_Data_Industry_Landscape_03.html">The Orchestration Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04a_Intro_Ray_Data_Industry_Landscape_04.html">Distributed Computing Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04a_Intro_Ray_Data_Industry_Landscape_05.html">Data Processing with Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04a_Intro_Ray_Data_Industry_Landscape_06.html">Ray Serve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04b_Intro_Ray_Data_Structured_01.html">Introduction to Ray Data: Ray Data + Structured Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04b_Intro_Ray_Data_Structured_02.html">0. What is Ray Data?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04b_Intro_Ray_Data_Structured_03.html">2. Loading Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04b_Intro_Ray_Data_Structured_04.html">3. Transforming Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04b_Intro_Ray_Data_Structured_05.html">4. Writing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04b_Intro_Ray_Data_Structured_06.html">5. Data Operations: Shuffling, Grouping and Aggregation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04b_Intro_Ray_Data_Structured_07.html">6. When to use Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_01.html">Intro to Ray Data:  Ray Data + Unstructured Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_02.html">1. When to Consider Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_03.html">2. How to work with Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_04.html">3. Loading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_05.html">3. Lazy execution mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_06.html">4. Transforming data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_07.html">5. Stateful transformations with Ray Actors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_08.html">6. Materializing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_09.html">7. Data Operations: grouping, aggregation, and shuffling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_10.html">8. Persisting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/04c_Intro_Ray_Data_Unstructured_11.html">9. Ray Data in production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/05_Intro_Ray_Serve_PyTorch_01.html">Introduction to Ray Serve with PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/05_Intro_Ray_Serve_PyTorch_02.html">1. When to Consider Ray Serve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/05_Intro_Ray_Serve_PyTorch_03.html">2. Overview of Ray Serve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/05_Intro_Ray_Serve_PyTorch_04.html">3. Implement an image classification service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/05_Intro_Ray_Serve_PyTorch_05.html">4. Development workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Developer_Intro_to_Ray/output/README_01.html">Introduction to Ray: Developer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">02 Anyscale Admin</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_00_Anyscale_Admin_Overview/output/anyscale_administrator_overview_01.html">Anyscale Administrator Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_00_Anyscale_Admin_Overview/output/anyscale_administrator_overview_02.html">1. What is an Anyscale Cloud?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_00_Anyscale_Admin_Overview/output/anyscale_administrator_overview_03.html">2. Cloud Deployment Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_00_Anyscale_Admin_Overview/output/anyscale_administrator_overview_04.html">3. A Demonstrative Example of Resource Creation with AWS EC2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_00_Anyscale_Admin_Overview/output/anyscale_administrator_overview_05.html">3.1 IAM Role Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_00_Anyscale_Admin_Overview/output/anyscale_administrator_overview_06.html">4. Register Anyscale Cloud to Your Cloud Provider</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_01_VM_vs_K8s/output/anyscale_vm_vs_k8s_01.html">Deployment Options: Virtual Machines vs. Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_01_VM_vs_K8s/output/anyscale_vm_vs_k8s_02.html">2. Virtual Machines (VM) vs. Kubernetes (K8s)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_01_VM_vs_K8s/output/anyscale_vm_vs_k8s_03.html">3. (Optional) More Kubernetes Deployments Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02a_Deploy_to_VM_AWS_EC2/output/deploy_to_ec2_01.html">Introduction: Deploy Anyscale Ray on AWS EC2 Instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02a_Deploy_to_VM_AWS_EC2/output/deploy_to_ec2_02.html">1. Create Anyscale Resources with Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02a_Deploy_to_VM_AWS_EC2/output/deploy_to_ec2_03.html">2. Register the Anyscale Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02a_Deploy_to_VM_AWS_EC2/output/deploy_to_ec2_04.html">3. Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02a_Deploy_to_VM_AWS_EC2/output/deploy_to_ec2_05.html">4. Cleanup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02a_Deploy_to_VM_AWS_EC2/output/deploy_to_ec2_06.html">5. Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02b_Deploy_to_VM_GCP_GCE/output/deploy_to_GCE_01.html">Introduction: Deploy Anyscale Ray on GCP Compute Engine Instances (GCE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02b_Deploy_to_VM_GCP_GCE/output/deploy_to_GCE_02.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02b_Deploy_to_VM_GCP_GCE/output/deploy_to_GCE_03.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02b_Deploy_to_VM_GCP_GCE/output/deploy_to_GCE_04.html">2. Create Anyscale Resources with Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02b_Deploy_to_VM_GCP_GCE/output/deploy_to_GCE_05.html">3. Register the Anyscale Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02b_Deploy_to_VM_GCP_GCE/output/deploy_to_GCE_06.html">4. Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_02b_Deploy_to_VM_GCP_GCE/output/deploy_to_GCE_07.html">5. Cleanup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_01.html">Introduction: Deploy Anyscale Ray on A New AWS EKS Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_02.html">1. Create Anyscale Resources with Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_03.html">2. Install Kubernetes Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_04.html">3. Register the Anyscale Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_05.html">4. Install the Anyscale Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_06.html">5. Verify the Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_07.html">6. Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_08.html">7. Clean up</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03a_Deploy_to_K8s_New_AWS_EKS/output/deploy_to_a_new_EKS_09.html">8. Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_01.html">Introduction: Deploy Anyscale Ray on An Existing AWS EKS Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_02.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_03.html">1. Create Anyscale Resources with Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_04.html">2. Attach Required IAM Policies to Your existing EKS‚Äôs Node Role</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_05.html">3. Install Kubernetes Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_06.html">4. Register the Anyscale Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_07.html">5. Install the Anyscale Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_08.html">6. Verify the Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_09.html">7. Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_10.html">8. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_11.html">9. Clean up</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03b_Deploy_to_K8s_Existing_AWS_EKS/output/deploy_to_an_existing_EKS_12.html">10. Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_01.html">Introduction: Deploy Anyscale Ray on A New Google Kubernetes Engine (GKE) Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_02.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_03.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_04.html">2. Create Anyscale Resources with Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_05.html">3. Troubleshooting GPU Availability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_06.html">4. kubectl Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_07.html">5. Install NGINX Ingress Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_08.html">6. (Optional) Upgrade Anyscale Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_09.html">7. Register the Anyscale Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_10.html">8. Install the Anyscale Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_11.html">8. Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Anyscale_Admin/02_03c_Deploy_to_K8s_New_GCP_GKE/output/deploy_to_new_GKE_12.html">9. Cleanup</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">03 Observability</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/output/01_general_intro_and_setup_01.html">Observability Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/output/01_general_intro_and_setup_02.html">Observability Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/output/01_general_intro_and_setup_03.html">Setting Up Local Ray Observability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/02_Ray_Anyscale_Introduction/output/2_Ray_Anyscale_Observability_Overview_01.html">Ray and Anyscale Observability Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/02_Ray_Anyscale_Introduction/output/2_Ray_Anyscale_Observability_Overview_02.html">Ray Observability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/02_Ray_Anyscale_Introduction/output/2_Ray_Anyscale_Observability_Overview_03.html">Anyscale Observability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/02_Ray_Anyscale_Introduction/output/2_Ray_Anyscale_Observability_Overview_04.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/03_Ray_Anyscale_Observability_in_Detail/output/03_Ray_Anyscale_Observability_in_Details_01.html">Ray and Anyscale Observability in Detail</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/03_Ray_Anyscale_Observability_in_Detail/output/03_Ray_Anyscale_Observability_in_Details_02.html">Data Pipeline Observability (Ray Data)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Observability/03_Ray_Anyscale_Observability_in_Detail/output/03_Ray_Anyscale_Observability_in_Details_03.html">Web Application Observability (Ray Serve)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Gettingstarted</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_01_anyscale_intro_workspace_01.html">101 ‚Äî Introduction to Anyscale Workspaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_02_anyscale_development_intro_01.html">101 ‚Äì Developing Application with Anyscale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_03_anyscale_compute_runtime_intro_01.html">101 ‚Äì Compute Configs and Execution Environments in Anyscale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_04_anyscale_storage_options_01.html">101 ‚Äì Storage Options in the Anyscale Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_05_anyscale_logging_metrics_01.html">101 ‚Äì Debug and Monitor Your Anyscale Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_06_anyscale_intro_jobs_01.html">101 ‚Äì Introduction to Anyscale Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_07_anyscale_intro_services_01.html">101 ‚Äì  Introduction to Anyscale Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_08_anyscale_collaboration_01.html">101 ‚Äì Collaboration on Anyscale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_09_anyscale_org_setup_01.html">101 - Anyscale Organization and Cloud Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_09_anyscale_org_setup_02.html">üìå Overview of Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_09_anyscale_org_setup_03.html">üß† Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_anyscale_intro_jobs_01.html">Content Used</a></li>

<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_anyscale_intro_jobs_02.html">Part 1. Creating and Submitting your first job</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_anyscale_intro_jobs_03.html">Part 2. Automation and Scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_anyscale_intro_services_01.html">Sources</a></li>

<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/output/101_anyscale_intro_services_02.html">Part 1: Starting your first Anyscale Service</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ray Train Foundation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_01.html">üìö 01 ¬∑ Introduction to Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_02.html">01 ¬∑ Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_03.html">04 ¬∑ Define ResNet-18 Model for MNIST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_04.html">05 ¬∑ Define the Ray Train Loop (DDP per-worker)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_05.html">06 ¬∑ Define <code class="docutils literal notranslate"><span class="pre">train_loop_config</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_06.html">07 ¬∑ Configure Scaling with <code class="docutils literal notranslate"><span class="pre">ScalingConfig</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_07.html">08 ¬∑ Wrap the Model with <code class="docutils literal notranslate"><span class="pre">prepare_model()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_08.html">09 ¬∑ Build the DataLoader with <code class="docutils literal notranslate"><span class="pre">prepare_data_loader()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_09.html">10 ¬∑ Report Training Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_10.html">11 ¬∑ Save Checkpoints and Report Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_11.html">14 ¬∑ Create the <code class="docutils literal notranslate"><span class="pre">TorchTrainer</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_12.html">16 ¬∑ Inspect the Training Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_13.html">18 ¬∑ Load a Checkpoint for Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_14.html">üîÑ 02 ¬∑ Integrating Ray Train with Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_15.html">01 ¬∑ Define Training Loop with Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_16.html">02 ¬∑ Build DataLoader from Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_17.html">03 ¬∑ Prepare Dataset for Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_18.html">05 ¬∑ Define Image Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_19.html">07 ¬∑ Configure <code class="docutils literal notranslate"><span class="pre">TorchTrainer</span></code> with Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_20.html">üõ°Ô∏è 03 ¬∑ Fault Tolerance in Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_21.html">01 ¬∑ Modify Training Loop to Enable Checkpoint Loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_22.html">02 ¬∑ Save Full Checkpoint with Extra State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_23.html">04 ¬∑ Launch Fault-Tolerant Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_24.html">05 ¬∑ Manual Restoration from Checkpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_25.html">07 ¬∑ Clean Up Cluster Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Ray_Train_Foundation/output/01_02_03_intro_to_ray_train_26.html">üéâ Wrapping Up &amp; Next Steps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Ray Data Batch Inference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Data_Batch_Inference/output/01_Ray_Data_batch_inference_01.html">Batch Inference with Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Data_Batch_Inference/output/01_Ray_Data_batch_inference_02.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Data_Batch_Inference/output/01_Ray_Data_batch_inference_03.html">Load a dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Data_Batch_Inference/output/01_Ray_Data_batch_inference_04.html">Batch Inference Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Data_Batch_Inference/output/01_Ray_Data_batch_inference_05.html">Create a batch data and call the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Data_Batch_Inference/output/01_Ray_Data_batch_inference_06.html">Run inference on the entire dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Ray Data Processing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="output/02_Ray_Data_data_processing_01.html">Data Processing with Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="output/02_Ray_Data_data_processing_02.html">Library Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="output/02_Ray_Data_data_processing_03.html">Convert to Ray Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="output/02_Ray_Data_data_processing_04.html">Filter Ray Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="output/02_Ray_Data_data_processing_05.html">Join Two Ray Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="output/02_Ray_Data_data_processing_06.html">Preprocessing with a Tokenizer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Ray Distributed Training</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Distributed_Training/output/04_Ray_Train_distributed_training_01.html">Distributed training with Ray Train, PyTorch and Hugging Face</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Distributed_Training/output/04_Ray_Train_distributed_training_02.html">1. Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Distributed_Training/output/04_Ray_Train_distributed_training_03.html">3. Metrics Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Distributed_Training/output/04_Ray_Train_distributed_training_04.html">4. Training function per worker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Distributed_Training/output/04_Ray_Train_distributed_training_05.html">5. Main Training Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Distributed_Training/output/04_Ray_Train_distributed_training_06.html">6. Start Training</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Ray Serve Online Serving</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Serve_Online_Serving/output/03_Ray_Serve_online_serving_01.html">Online Model Serving with Ray Serve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Serve_Online_Serving/output/03_Ray_Serve_online_serving_02.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Serve_Online_Serving/output/03_Ray_Serve_online_serving_03.html">FastAPI webservice and deploy a model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Ray_Serve_Online_Serving/output/03_Ray_Serve_online_serving_04.html">Simulate Client: Send test requests</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Train Generative Cv</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Generative_CV/output/04d1_generative_cv_pattern_01.html">04-d1 Generative computer-vision pattern with Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Generative_CV/output/04d1_generative_cv_pattern_02.html">1. Imports and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Generative_CV/output/04d1_generative_cv_pattern_03.html">8. Pixel diffusion LightningModule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Generative_CV/output/04d1_generative_cv_pattern_04.html">9. Ray Train <code class="docutils literal notranslate"><span class="pre">train_loop</span></code> (Lightning + Ray integration)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Generative_CV/output/04d1_generative_cv_pattern_05.html">12. Resume from latest checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Generative_CV/output/04d1_generative_cv_pattern_06.html">13. Reverse diffusion sampler</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Train Policy Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Policy_Learning/output/04d2_policy_learning_pattern_01.html">04-d2 Diffusion-Policy Pattern with Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Policy_Learning/output/04d2_policy_learning_pattern_02.html">1. Imports and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Policy_Learning/output/04d2_policy_learning_pattern_03.html">4. DiffusionPolicy LightningModule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Policy_Learning/output/04d2_policy_learning_pattern_04.html">5. Distributed Train loop with checkpointing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Policy_Learning/output/04d2_policy_learning_pattern_05.html">8. Reverse diffusion helper</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Train Rec Sys</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Rec_sys/output/04e_rec_sys_workload_pattern_01.html">04e Recommendation system pattern with Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Rec_sys/output/04e_rec_sys_workload_pattern_02.html">1. Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Rec_sys/output/04e_rec_sys_workload_pattern_03.html">7. Define matrix factorization model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Rec_sys/output/04e_rec_sys_workload_pattern_04.html">8. Define Ray Train loop (with validation, checkpointing, and Ray-managed metrics)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Rec_sys/output/04e_rec_sys_workload_pattern_05.html">11. Resume training from checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Rec_sys/output/04e_rec_sys_workload_pattern_06.html">12. Inference: recommend top-N items for a user</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Train Tabular</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Tabular/output/04b_tabular_workload_pattern_01.html">04b Tabular workload pattern with Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Tabular/output/04b_tabular_workload_pattern_02.html">1. Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Tabular/output/04b_tabular_workload_pattern_03.html">8. Define the Ray Train worker loop (Arrow-based, memory-efficient)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Tabular/output/04b_tabular_workload_pattern_04.html">12. Confusion matrix visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Tabular/output/04b_tabular_workload_pattern_05.html">15. Continue training from the latest checkpoint</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Train Time Series</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Time_Series/output/04c_time_series_workload_pattern_01.html">04c Time-Series workload pattern with Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Time_Series/output/04c_time_series_workload_pattern_02.html">1. Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Time_Series/output/04c_time_series_workload_pattern_03.html">9. PositionalEncoding and Transformer model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Time_Series/output/04c_time_series_workload_pattern_04.html">10. Ray Train training loop (with teacher forcing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Time_Series/output/04c_time_series_workload_pattern_05.html">13. Resume training from checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Time_Series/output/04c_time_series_workload_pattern_06.html">14. Inference helper ‚Äî Ray Data batch predictor on GPU</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wl Train Vision Pattern</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_01.html">04a Computer-vision pattern with Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_02.html">1. Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_03.html">6. Custom <code class="docutils literal notranslate"><span class="pre">Food101Dataset</span></code> for Parquet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_04.html">10. Helper: Ray-prepared DataLoaders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_05.html">11. <code class="docutils literal notranslate"><span class="pre">train_loop_per_worker</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_06.html">12. Launch distributed training with <code class="docutils literal notranslate"><span class="pre">TorchTrainer</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_07.html">13. Plot training and validation loss curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_08.html">14. Demonstrate fault-tolerant resumption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WL_Train_Vision_Pattern/output/04a_vision_pattern_09.html">15. Batch inference with Ray Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Llm Serving</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/00_intro_serve_llm/output/notebook_01.html">Introduction to Ray Serve LLM: Foundations of Large Language Model Serving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/00_intro_serve_llm/output/notebook_02.html">What is LLM Serving?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/00_intro_serve_llm/output/notebook_03.html">Key Concepts and Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/00_intro_serve_llm/output/notebook_04.html">Challenges in LLM Serving</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/00_intro_serve_llm/output/notebook_05.html">Ray Serve LLM + Anyscale Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/00_intro_serve_llm/output/notebook_06.html">Getting Started with Ray Serve LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/00_intro_serve_llm/output/notebook_07.html">Key Takeaways</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/01_deploy_medium_llm/output/notebook_01.html">Deploy a Medium-Sized LLM with Ray Serve LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/01_deploy_medium_llm/output/notebook_02.html">Overview: Why Medium-Sized Models?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/01_deploy_medium_llm/output/notebook_03.html">Setting up Ray Serve LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/01_deploy_medium_llm/output/notebook_04.html">Local Deployment &amp; Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/01_deploy_medium_llm/output/notebook_05.html">Deploying to Anyscale Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/01_deploy_medium_llm/output/notebook_06.html">Advanced Topics: Monitoring &amp; Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/01_deploy_medium_llm/output/notebook_07.html">Summary &amp; Outlook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/02_advanced_llm_features/output/notebook_01.html">Advanced LLM Features with Ray Serve LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/02_advanced_llm_features/output/notebook_02.html">Overview: Advanced Features Preview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/02_advanced_llm_features/output/notebook_03.html">Example: Deploying LoRA Adapters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/02_advanced_llm_features/output/notebook_04.html">Example: Getting Structured JSON Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/02_advanced_llm_features/output/notebook_05.html">Example: Setting up Tool Calling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/02_advanced_llm_features/output/notebook_06.html">How to Choose an LLM?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llm_serving/02_advanced_llm_features/output/notebook_07.html">Conclusion: Next Steps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ray 101</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/1_AI_Libs_Intro_01.html">Introduction to the Ray AI Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/1_AI_Libs_Intro_02.html">1. Overview of the Ray AI Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/1_AI_Libs_Intro_03.html">2. End-to-end example: predicting taxi tips in New York</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_01.html">Introduction to Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_02.html">1. PyTorch introductory example (single GPU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_03.html">2. Distributed Data Parallel Training with Ray Train and PyTorch (multiple GPUs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_04.html">3. Overview of the training loop in Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_05.html">4. Migrating the model and dataset to Ray Train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_06.html">5. Reporting checkpoints and metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_07.html">6. Launching the distributed training job</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_08.html">7. Accessing the training results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/2_Intro_Train_09.html">8. Ray Train in Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/3_Intro_Tune_01.html">Intro to Ray Tune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/3_Intro_Tune_02.html">1. Loading and visualizing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/3_Intro_Tune_03.html">2. Setting up a PyTorch model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/3_Intro_Tune_04.html">3. Introduction to Ray Tune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/3_Intro_Tune_05.html">4. Diving deeper into Ray Tune concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/3_Intro_Tune_06.html">5. Hyperparameter tuning the PyTorch model using Ray Tune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/4_Intro_Data_01.html">Intro to Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/4_Intro_Data_02.html">1. When to use Ray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/4_Intro_Data_03.html">2. Loading Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/4_Intro_Data_04.html">3. Transforming Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/4_Intro_Data_05.html">4. Data Operations: Grouping, Aggregation, and Shuffling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/4_Intro_Data_06.html">5. Persisting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/5_Intro_Serve_01.html">Intro to Ray Serve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/5_Intro_Serve_02.html">1. Overview of Ray Serve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/5_Intro_Serve_03.html">2. Implement an Classifier service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/5_Intro_Serve_04.html">3. Advanced features of Ray Serve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/5_Intro_Serve_05.html">4. Ray Serve in Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ray-101/output/5_Intro_Serve_06.html">Clean up</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/courses/WL_Ray_Data_Processing/02_Ray_Data_data_processing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Processing with Ray Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outline-of-the-notebook">Outline of the notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#library-imports">Library Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-ray-and-load-a-dataset">Initialize Ray and Load a Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-to-ray-dataset">Convert to Ray Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-second-dataset">Create a Second Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-ray-dataset">Filter Ray Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#join-two-ray-datasets">Join Two Ray Datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-with-a-tokenizer">Preprocessing with a Tokenizer</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-to-pandas-dataframe">Convert to Pandas DataFrame</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shutdown-ray">Shutdown Ray</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-processing-with-ray-data">
<h1>Data Processing with Ray Data<a class="headerlink" href="#data-processing-with-ray-data" title="Link to this heading">#</a></h1>
<p>¬© 2025, Anyscale. All Rights Reserved</p>
<p>üíª <strong>Launch Locally</strong>: You can run this notebook locally.</p>
<p>üöÄ <strong>Launch on Cloud</strong>: Think about running this notebook on a Ray Cluster (Click <a class="reference external" href="http://console.anyscale.com/register">here</a> to easily start a Ray cluster on Anyscale)</p>
<p>Data preprocessing is a crucial step in any machine learning workflow, and Ray Data provides a scalable and flexible way to handle this process on large datasets. With Ray Data, you can efficiently load, transform, filter, and join datasets using a distributed framework that leverages the power of multiple CPUs or nodes. This makes it possible to preprocess data that would be too large to fit into memory on a single machine, enabling seamless scaling from your laptop to a cluster.</p>
<p>Ray Data supports a variety of preprocessing operations, such as filtering rows based on conditions, joining multiple datasets, and applying custom transformations like tokenization or label encoding. For example, you can load a large public dataset like IMDB reviews, filter for only positive reviews, join with metadata, and tokenize the text‚Äîall in a distributed and parallelized manner. This approach not only speeds up data preparation but also integrates smoothly with downstream machine learning tasks, making Ray Data a powerful tool for modern data pipelines.</p>
<section id="outline-of-the-notebook">
<h2>Outline of the notebook<a class="headerlink" href="#outline-of-the-notebook" title="Link to this heading">#</a></h2>
<p>This notebook shows a few examples on how to preprocess data with Ray Data.</p>
<div class="alert alert-block alert-info">
<ul>
    <li>Library Imports
    <li>Initialize Ray and Load a Large Public Dataset
    <li>Convert to Ray Dataset
    <li>Create a Second Dataset
    <li>Filtering Data
    <li>Joining Datasets
    <li>Tokenization and Preprocessing
    <li>Converting to Pandas DataFrame
    <li>Shutting Down Ray
    <li>Conclusion
</ul>
</div></section>
<section id="library-imports">
<h2>Library Imports<a class="headerlink" href="#library-imports" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">ray</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="c1"># showcase ray data transformations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ray.data.preprocessors</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tokenizer</span>
</pre></div>
</div>
</div>
</div>
<section id="initialize-ray-and-load-a-dataset">
<h3>Initialize Ray and Load a Dataset<a class="headerlink" href="#initialize-ray-and-load-a-dataset" title="Link to this heading">#</a></h3>
<p>Load a public dataset from Hugging Face and explore the dataset with a few sample rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start Ray</span>
<span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "54e0c9d74a4b4dfaa7b5f12524ab6aff", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the IMDB dataset from Hugging Face Datasets (train split)</span>
<span class="n">imdb</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;imdb&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">imdb</span><span class="p">)</span> <span class="c1"># show the dataset structure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset({
    features: [&#39;text&#39;, &#39;label&#39;],
    num_rows: 25000
})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imdb</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Show the first 3 rows of the dataset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;text&#39;: [&#39;I rented I AM CURIOUS-YELLOW from my video store because of all the controversy that surrounded it when it was first released in 1967. I also heard that at first it was seized by U.S. customs if it ever tried to enter this country, therefore being a fan of films considered &quot;controversial&quot; I really had to see this for myself.&lt;br /&gt;&lt;br /&gt;The plot is centered around a young Swedish drama student named Lena who wants to learn everything she can about life. In particular she wants to focus her attentions to making some sort of documentary on what the average Swede thought about certain political issues such as the Vietnam War and race issues in the United States. In between asking politicians and ordinary denizens of Stockholm about their opinions on politics, she has sex with her drama teacher, classmates, and married men.&lt;br /&gt;&lt;br /&gt;What kills me about I AM CURIOUS-YELLOW is that 40 years ago, this was considered pornographic. Really, the sex and nudity scenes are few and far between, even then it\&#39;s not shot like some cheaply made porno. While my countrymen mind find it shocking, in reality sex and nudity are a major staple in Swedish cinema. Even Ingmar Bergman, arguably their answer to good old boy John Ford, had sex scenes in his films.&lt;br /&gt;&lt;br /&gt;I do commend the filmmakers for the fact that any sex shown in the film is shown for artistic purposes rather than just to shock people and make money to be shown in pornographic theaters in America. I AM CURIOUS-YELLOW is a good film for anyone wanting to study the meat and potatoes (no pun intended) of Swedish cinema. But really, this film doesn\&#39;t have much of a plot.&#39;,
  &#39;&quot;I Am Curious: Yellow&quot; is a risible and pretentious steaming pile. It doesn\&#39;t matter what one\&#39;s political views are because this film can hardly be taken seriously on any level. As for the claim that frontal male nudity is an automatic NC-17, that isn\&#39;t true. I\&#39;ve seen R-rated films with male nudity. Granted, they only offer some fleeting views, but where are the R-rated films with gaping vulvas and flapping labia? Nowhere, because they don\&#39;t exist. The same goes for those crappy cable shows: schlongs swinging in the breeze but not a clitoris in sight. And those pretentious indie movies like The Brown Bunny, in which we\&#39;re treated to the site of Vincent Gallo\&#39;s throbbing johnson, but not a trace of pink visible on Chloe Sevigny. Before crying (or implying) &quot;double-standard&quot; in matters of nudity, the mentally obtuse should take into account one unavoidably obvious anatomical difference between men and women: there are no genitals on display when actresses appears nude, and the same cannot be said for a man. In fact, you generally won\&#39;t see female genitals in an American film in anything short of porn or explicit erotica. This alleged double-standard is less a double standard than an admittedly depressing ability to come to terms culturally with the insides of women\&#39;s bodies.&#39;,
  &quot;If only to avoid making this type of film in the future. This film is interesting as an experiment but tells no cogent story.&lt;br /&gt;&lt;br /&gt;One might feel virtuous for sitting thru it because it touches on so many IMPORTANT issues but it does so without any discernable motive. The viewer comes away with no new perspectives (unless one comes up with one while one&#39;s mind wanders, as it will invariably do during this pointless film).&lt;br /&gt;&lt;br /&gt;One might better spend one&#39;s time staring out a window at a tree growing.&lt;br /&gt;&lt;br /&gt;&quot;],
 &#39;label&#39;: [0, 0, 0]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 0 = negative, 1 = positive</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of positive labels = &#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">imdb</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of positive labels =  12500
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="convert-to-ray-dataset">
<h2>Convert to Ray Dataset<a class="headerlink" href="#convert-to-ray-dataset" title="Link to this heading">#</a></h2>
<p>Add unique IDs to each row and create a Ray Dataset. Ray Dataset is distributed across the nodes and enables parallel computations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add id and convert to Ray Dataset</span>
<span class="n">ds_reviews</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">from_items</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">imdb</span><span class="p">)</span>
<span class="p">])</span> <span class="c1"># add id to each row</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ds_reviews</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MaterializedDataset(
   num_blocks=200,
   num_rows=25000,
   schema={id: int64, text: string, label: int64}
)
</pre></div>
</div>
</div>
</div>
<section id="create-a-second-dataset">
<h3>Create a Second Dataset<a class="headerlink" href="#create-a-second-dataset" title="Link to this heading">#</a></h3>
<p>Here we create a second dataset (fake metadata) with some rows with common IDs as in ds_reviews data. In practice, you would have a real metadata or another dataset. This used to show join operation between two Ray datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a second dataset: pretend we have metadata (source column) for every 100th row.</span>
<span class="c1"># This is just for demonstration purposes; in practice, you would have a real metadata source.</span>
<span class="n">ds_meta</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">from_items</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;imdb&quot;</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">imdb</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ds_meta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MaterializedDataset(
   num_blocks=200,
   num_rows=250,
   schema={id: int64, source: string}
)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="filter-ray-dataset">
<h2>Filter Ray Dataset<a class="headerlink" href="#filter-ray-dataset" title="Link to this heading">#</a></h2>
<p>This show how to filter some rows in a Ray dataset. In this example, a filter expression is applied to keep only positive reviews.</p>
<ul class="simple">
<li><p>Filter can be an expression or a function. Expression API is faster than functional API.</p></li>
<li><p>Concurrency parameter is used to launch multiple workers. If it not set (default), number of workers is determined by the available resources and the number of input blocks.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter: keep only positive reviews</span>
<span class="c1"># using expression API, faster than lambda</span>
<span class="c1"># concurrency=2 is used to parallelize the filtering operation</span>
<span class="c1"># Note: If you have a large dataset, consider using a larger concurrency value for better performance</span>
<span class="c1"># filtered = ds_reviews.filter(expr=&quot;label == 1&quot;, concurrency=2)</span>

<span class="c1"># functional API, slower than expression API</span>
<span class="n">filtered</span> <span class="o">=</span> <span class="n">ds_reviews</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filter(&lt;lambda&gt;)
+- Dataset(num_rows=25000, schema={id: int64, text: string, label: int64})
</pre></div>
</div>
</div>
</div>
</section>
<section id="join-two-ray-datasets">
<h2>Join Two Ray Datasets<a class="headerlink" href="#join-two-ray-datasets" title="Link to this heading">#</a></h2>
<p>Here we show a join operation by joining the filtered reviews with the metadata dataset on ‚Äòid‚Äô. This is a simple inner join operation to demonstrate how to combine datasets.</p>
<p>Note: num_partitions=2 is used here for demonstration; adjust based on your dataset
size and performance needs. The join operation can be expensive, so consider the size of your datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Join: inner join on &#39;id&#39;</span>
<span class="n">joined</span> <span class="o">=</span> <span class="n">filtered</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ds_meta</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,),</span> <span class="n">join_type</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">num_partitions</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show a few joined results</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">joined</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c9df6b8422bd4c2ea8181a82fac22ee7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f97dc6fb04ec4b3db26f700e6013c181", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ef9484dac4154b2ba3300e9e4472d957", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1ad8caa26a4748609a90fd7c0b293c28", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;id&#39;: 12500, &#39;text&#39;: &#39;Zentropa has much in common with The Third Man, another noir-like film set among the rubble of postwar Europe. Like TTM, there is much inventive camera work. There is an innocent American who gets emotionally involved with a woman he doesn\&#39;t really understand, and whose naivety is all the more striking in contrast with the natives.&lt;br /&gt;&lt;br /&gt;But I\&#39;d have to say that The Third Man has a more well-crafted storyline. Zentropa is a bit disjointed in this respect. Perhaps this is intentional: it is presented as a dream/nightmare, and making it too coherent would spoil the effect. &lt;br /&gt;&lt;br /&gt;This movie is unrelentingly grim--&quot;noir&quot; in more than one sense; one never sees the sun shine. Grim, but intriguing, and frightening.&#39;, &#39;label&#39;: 1, &#39;source&#39;: &#39;imdb&#39;}
{&#39;id&#39;: 13000, &#39;text&#39;: &quot;Visually stunning and full of Eastern Philosophy, this amazing martial arts fantasy is brought to you by master director Tsui Hark, the man behind some of the best films Hong Kong cinema has produced. The special effects are beautiful and imaginative. The plot is a bit on the cerebral side, but is a refreshing change from films that treat their audience as if they were morons. If thinking is not your forte, however, this may not be your movie. Maybe you should go see the latest from the Hollywood studio&#39;s no brain club, but if you are looking for something more, he&#39;s where you will find it.&quot;, &#39;label&#39;: 1, &#39;source&#39;: &#39;imdb&#39;}
{&#39;id&#39;: 13100, &#39;text&#39;: &quot;The fourth of five westerns Anthony Mann did with James Stewart, this one involves a hard bitten cattleman named Jeff Webster who takes a cattle drive from Wyoming to Alaska, via Seattle. He hooks up in Seattle with his partners Ben Tatum (Walter Brennan) and Rube Morris (Jay C. Flippen) that he has sent ahead of time in order to make preparations for the boat trip, north.&lt;br /&gt;&lt;br /&gt;But first, he has to put up with insubordinate trail hands, cheating riverboat captains and the charms of coy, manipulative Ronda Castle (Ruth Roman) who believes Jeff could be a valuable ally in the future. That&#39;s why she hides him out on the boat while the captain&#39;s looking for him for the earlier (and justifiable) killing of a trail hand.&lt;br /&gt;&lt;br /&gt;Jeff also has the misfortune of running into sleazy Judge Gannon (John McIntire) who runs the town of Skagway, Alaska. Gannon locks Jeff up for disrupting his public hanging by running his cattle through town. He fines Jeff the ownership of his cattle and Jeff just has to eat crow for the time being. &lt;br /&gt;&lt;br /&gt;In the meantime, Jeff agrees to ride point for Ronda up to Dawson in order to deliver supplies. But this is just a ruse so Jeff, Ben and Rube can slip back into Skagway and steal his cattle back. Of course Judge Gannon finds out about this and is right behind but is delayed by Jeff with a rifle while Ben races the cattle over the Canadian border out of Gannon&#39;s reach.&lt;br /&gt;&lt;br /&gt;After avoiding an avalanche and another shootout with some other Skagway men, they finally reach Dawson where Jeff sells his cattle to the highest bidder, which just happens to be Ronda who then promptly sets up a new gambling house in Dawson. Jeff then takes his money and buys himself a claim and starts panning for gold. &lt;br /&gt;&lt;br /&gt;But then Judge Gannon comes up to Dawson to get in on the gold action up there, and tells Jeff that he was getting a little bored with Skagway and wants to try his luck up in the Klondike, himself. That involves bring some hired gunman with him and forcibly stealing some of the other miner&#39;s claims. Jeff and Ben now feel it&#39;s time to clear out while the goings are good, leaving Rube to fend for himself as a most ineffective sheriff against Gannon and his gang.&lt;br /&gt;&lt;br /&gt;They look for a back way out only to find themselves ambushed by Gannon&#39;s men because Ben made the mistake of opening his big mouth. Ben is killed and Jeff is severely wounded but that doesn&#39;t save Judge Gannon from his just due. The ending shootout at night on the muddy Dawson street pretty much takes care of that. First Jeff kills two of Gannon&#39;s best gunman (Jack Elam and Robert Wilkie). Then as Ronda comes out to warn Jeff that Gannon is trying to slip around behind him, Gannon shoots her in the back and she dies right there in Jeff&#39;s arms. Then Jeff kills Gannon as he&#39;s hiding under a wooden sidewalk. Revenge has spoken.&lt;br /&gt;&lt;br /&gt;This is another rip-roaring western that&#39;s right up there with THE NAKED SPUR and THE MAN FROM LARAMIE. Why the Universal DVD uses a pan-and-scan print instead of the widescreen print TCM uses, is beyond me. You&#39;ll wind up missing half the glorious Alberta cinematography by William Daniels. So if you like well-written 50s westerns, then this one&#39;s an A-list keeper. &lt;br /&gt;&lt;br /&gt;8 out of 10&quot;, &#39;label&#39;: 1, &#39;source&#39;: &#39;imdb&#39;}
{&#39;id&#39;: 13600, &#39;text&#39;: &quot;I miss Dark Angel!..&lt;br /&gt;&lt;br /&gt;I understand not ever one likes it, but as far as I&#39;m concerned the show should not have been canceled, especially for another space show mock up...&lt;br /&gt;&lt;br /&gt;I&#39;m reading the books now. they are doing a pretty good job of explaining somethings, but I still think we should get a TV movie or something.&lt;br /&gt;&lt;br /&gt;THE FREAK NATION LIVES!!!!!!!!&quot;, &#39;label&#39;: 1, &#39;source&#39;: &#39;imdb&#39;}
{&#39;id&#39;: 13700, &#39;text&#39;: &quot;I like the good and evil battle. I liked Eddie in this movie better than any movie he has ever done. He wasn&#39;t The smart, cocky, know it all he usually plays. He shows heart and a more humble humor. The fact that it shows there are stranger things in Heaven and on earth than we can think of gives me hope.&quot;, &#39;label&#39;: 1, &#39;source&#39;: &#39;imdb&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="preprocessing-with-a-tokenizer">
<h2>Preprocessing with a Tokenizer<a class="headerlink" href="#preprocessing-with-a-tokenizer" title="Link to this heading">#</a></h2>
<p>This showcases a preprocessing method that tokenizes the text column using custom tokenization function. Such preprocessing methods are useful in preparing the data for training a model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
<span class="c1"># Define a tokenizer for the text column</span>
<span class="k">def</span><span class="w"> </span><span class="nf">tokenization_fn</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">character</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="c1"># tokenizer = Tokenizer(columns=[&quot;text&quot;], tokenization_fn=tokenization_fn)</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span> <span class="n">output_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;text_tokenized&quot;</span><span class="p">],</span>
                      <span class="n">tokenization_fn</span><span class="o">=</span><span class="n">tokenization_fn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print tokenizer sample</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cb40f1aa8df74795b10bd834ef66cb43", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5578efcf44834e9081aa0a5def20f589", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "220cffeb3b6244a78fc3f1fd48bd34ad", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;id&#39;: 12500, &#39;text&#39;: &#39;Zentropa has much in common with The Third Man, another noir-like film set among the rubble of postwar Europe. Like TTM, there is much inventive camera work. There is an innocent American who gets emotionally involved with a woman he doesn\&#39;t really understand, and whose naivety is all the more striking in contrast with the natives.&lt;br /&gt;&lt;br /&gt;But I\&#39;d have to say that The Third Man has a more well-crafted storyline. Zentropa is a bit disjointed in this respect. Perhaps this is intentional: it is presented as a dream/nightmare, and making it too coherent would spoil the effect. &lt;br /&gt;&lt;br /&gt;This movie is unrelentingly grim--&quot;noir&quot; in more than one sense; one never sees the sun shine. Grim, but intriguing, and frightening.&#39;, &#39;label&#39;: 1, &#39;text_tokenized&#39;: [&#39;Zentropa&#39;, &#39;has&#39;, &#39;much&#39;, &#39;in&#39;, &#39;common&#39;, &#39;with&#39;, &#39;The&#39;, &#39;Third&#39;, &#39;Man&#39;, &#39;another&#39;, &#39;noirlike&#39;, &#39;film&#39;, &#39;set&#39;, &#39;among&#39;, &#39;the&#39;, &#39;rubble&#39;, &#39;of&#39;, &#39;postwar&#39;, &#39;Europe&#39;, &#39;Like&#39;, &#39;TTM&#39;, &#39;there&#39;, &#39;is&#39;, &#39;much&#39;, &#39;inventive&#39;, &#39;camera&#39;, &#39;work&#39;, &#39;There&#39;, &#39;is&#39;, &#39;an&#39;, &#39;innocent&#39;, &#39;American&#39;, &#39;who&#39;, &#39;gets&#39;, &#39;emotionally&#39;, &#39;involved&#39;, &#39;with&#39;, &#39;a&#39;, &#39;woman&#39;, &#39;he&#39;, &#39;doesnt&#39;, &#39;really&#39;, &#39;understand&#39;, &#39;and&#39;, &#39;whose&#39;, &#39;naivety&#39;, &#39;is&#39;, &#39;all&#39;, &#39;the&#39;, &#39;more&#39;, &#39;striking&#39;, &#39;in&#39;, &#39;contrast&#39;, &#39;with&#39;, &#39;the&#39;, &#39;nativesbr&#39;, &#39;br&#39;, &#39;But&#39;, &#39;Id&#39;, &#39;have&#39;, &#39;to&#39;, &#39;say&#39;, &#39;that&#39;, &#39;The&#39;, &#39;Third&#39;, &#39;Man&#39;, &#39;has&#39;, &#39;a&#39;, &#39;more&#39;, &#39;wellcrafted&#39;, &#39;storyline&#39;, &#39;Zentropa&#39;, &#39;is&#39;, &#39;a&#39;, &#39;bit&#39;, &#39;disjointed&#39;, &#39;in&#39;, &#39;this&#39;, &#39;respect&#39;, &#39;Perhaps&#39;, &#39;this&#39;, &#39;is&#39;, &#39;intentional&#39;, &#39;it&#39;, &#39;is&#39;, &#39;presented&#39;, &#39;as&#39;, &#39;a&#39;, &#39;dreamnightmare&#39;, &#39;and&#39;, &#39;making&#39;, &#39;it&#39;, &#39;too&#39;, &#39;coherent&#39;, &#39;would&#39;, &#39;spoil&#39;, &#39;the&#39;, &#39;effect&#39;, &#39;br&#39;, &#39;br&#39;, &#39;This&#39;, &#39;movie&#39;, &#39;is&#39;, &#39;unrelentingly&#39;, &#39;grimnoir&#39;, &#39;in&#39;, &#39;more&#39;, &#39;than&#39;, &#39;one&#39;, &#39;sense&#39;, &#39;one&#39;, &#39;never&#39;, &#39;sees&#39;, &#39;the&#39;, &#39;sun&#39;, &#39;shine&#39;, &#39;Grim&#39;, &#39;but&#39;, &#39;intriguing&#39;, &#39;and&#39;, &#39;frightening&#39;]}
{&#39;id&#39;: 12501, &#39;text&#39;: &quot;Zentropa is the most original movie I&#39;ve seen in years. If you like unique thrillers that are influenced by film noir, then this is just the right cure for all of those Hollywood summer blockbusters clogging the theaters these days. Von Trier&#39;s follow-ups like Breaking the Waves have gotten more acclaim, but this is really his best work. It is flashy without being distracting and offers the perfect combination of suspense and dark humor. It&#39;s too bad he decided handheld cameras were the wave of the future. It&#39;s hard to say who talked him away from the style he exhibits here, but it&#39;s everyone&#39;s loss that he went into his heavily theoretical dogma direction instead.&quot;, &#39;label&#39;: 1, &#39;text_tokenized&#39;: [&#39;Zentropa&#39;, &#39;is&#39;, &#39;the&#39;, &#39;most&#39;, &#39;original&#39;, &#39;movie&#39;, &#39;Ive&#39;, &#39;seen&#39;, &#39;in&#39;, &#39;years&#39;, &#39;If&#39;, &#39;you&#39;, &#39;like&#39;, &#39;unique&#39;, &#39;thrillers&#39;, &#39;that&#39;, &#39;are&#39;, &#39;influenced&#39;, &#39;by&#39;, &#39;film&#39;, &#39;noir&#39;, &#39;then&#39;, &#39;this&#39;, &#39;is&#39;, &#39;just&#39;, &#39;the&#39;, &#39;right&#39;, &#39;cure&#39;, &#39;for&#39;, &#39;all&#39;, &#39;of&#39;, &#39;those&#39;, &#39;Hollywood&#39;, &#39;summer&#39;, &#39;blockbusters&#39;, &#39;clogging&#39;, &#39;the&#39;, &#39;theaters&#39;, &#39;these&#39;, &#39;days&#39;, &#39;Von&#39;, &#39;Triers&#39;, &#39;followups&#39;, &#39;like&#39;, &#39;Breaking&#39;, &#39;the&#39;, &#39;Waves&#39;, &#39;have&#39;, &#39;gotten&#39;, &#39;more&#39;, &#39;acclaim&#39;, &#39;but&#39;, &#39;this&#39;, &#39;is&#39;, &#39;really&#39;, &#39;his&#39;, &#39;best&#39;, &#39;work&#39;, &#39;It&#39;, &#39;is&#39;, &#39;flashy&#39;, &#39;without&#39;, &#39;being&#39;, &#39;distracting&#39;, &#39;and&#39;, &#39;offers&#39;, &#39;the&#39;, &#39;perfect&#39;, &#39;combination&#39;, &#39;of&#39;, &#39;suspense&#39;, &#39;and&#39;, &#39;dark&#39;, &#39;humor&#39;, &#39;Its&#39;, &#39;too&#39;, &#39;bad&#39;, &#39;he&#39;, &#39;decided&#39;, &#39;handheld&#39;, &#39;cameras&#39;, &#39;were&#39;, &#39;the&#39;, &#39;wave&#39;, &#39;of&#39;, &#39;the&#39;, &#39;future&#39;, &#39;Its&#39;, &#39;hard&#39;, &#39;to&#39;, &#39;say&#39;, &#39;who&#39;, &#39;talked&#39;, &#39;him&#39;, &#39;away&#39;, &#39;from&#39;, &#39;the&#39;, &#39;style&#39;, &#39;he&#39;, &#39;exhibits&#39;, &#39;here&#39;, &#39;but&#39;, &#39;its&#39;, &#39;everyones&#39;, &#39;loss&#39;, &#39;that&#39;, &#39;he&#39;, &#39;went&#39;, &#39;into&#39;, &#39;his&#39;, &#39;heavily&#39;, &#39;theoretical&#39;, &#39;dogma&#39;, &#39;direction&#39;, &#39;instead&#39;]}
{&#39;id&#39;: 12502, &#39;text&#39;: &quot;Lars Von Trier is never backward in trying out new techniques. Some of them are very original while others are best forgotten.&lt;br /&gt;&lt;br /&gt;He depicts postwar Germany as a nightmarish train journey. With so many cities lying in ruins, Leo Kessler a young American of German descent feels obliged to help in their restoration. It is not a simple task as he quickly finds out.&lt;br /&gt;&lt;br /&gt;His uncle finds him a job as a night conductor on the Zentropa Railway Line. His job is to attend to the needs of the passengers. When the shoes are polished a chalk mark is made on the soles. A terrible argument ensues when a passenger&#39;s shoes are not chalked despite the fact they have been polished. There are many allusions to the German fanaticism of adherence to such stupid details.&lt;br /&gt;&lt;br /&gt;The railway journey is like an allegory representing man&#39;s procession through life with all its trials and tribulations. In one sequence Leo dashes through the back carriages to discover them filled with half-starved bodies appearing to have just escaped from Auschwitz . These images, horrible as they are, are fleeting as in a dream, each with its own terrible impact yet unconnected.&lt;br /&gt;&lt;br /&gt;At a station called Urmitz Leo jumps from the train with a parceled bomb. In view of many by-standers he connects the bomb to the underside of a carriage. He returns to his cabin and makes a connection to a time clock. Later he jumps from the train (at high speed) and lies in the cool grass on a river bank. Looking at the stars above he decides that his job is to build and not destroy. Subsequently as he sees the train approaching a giant bridge he runs at breakneck speed to board the train and stop the clock. If you care to analyse the situation it is a completely impossible task. Quite ridiculous in fact. It could only happen in a dream.&lt;br /&gt;&lt;br /&gt;It&#39;s strange how one remembers little details such as a row of cups hanging on hooks and rattling away with the swaying of the train.&lt;br /&gt;&lt;br /&gt;Despite the fact that this film is widely acclaimed, I prefer Lars Von Trier&#39;s later films (Breaking the Waves and The Idiots). The bomb scene described above really put me off. Perhaps I&#39;m a realist.&quot;, &#39;label&#39;: 1, &#39;text_tokenized&#39;: [&#39;Lars&#39;, &#39;Von&#39;, &#39;Trier&#39;, &#39;is&#39;, &#39;never&#39;, &#39;backward&#39;, &#39;in&#39;, &#39;trying&#39;, &#39;out&#39;, &#39;new&#39;, &#39;techniques&#39;, &#39;Some&#39;, &#39;of&#39;, &#39;them&#39;, &#39;are&#39;, &#39;very&#39;, &#39;original&#39;, &#39;while&#39;, &#39;others&#39;, &#39;are&#39;, &#39;best&#39;, &#39;forgottenbr&#39;, &#39;br&#39;, &#39;He&#39;, &#39;depicts&#39;, &#39;postwar&#39;, &#39;Germany&#39;, &#39;as&#39;, &#39;a&#39;, &#39;nightmarish&#39;, &#39;train&#39;, &#39;journey&#39;, &#39;With&#39;, &#39;so&#39;, &#39;many&#39;, &#39;cities&#39;, &#39;lying&#39;, &#39;in&#39;, &#39;ruins&#39;, &#39;Leo&#39;, &#39;Kessler&#39;, &#39;a&#39;, &#39;young&#39;, &#39;American&#39;, &#39;of&#39;, &#39;German&#39;, &#39;descent&#39;, &#39;feels&#39;, &#39;obliged&#39;, &#39;to&#39;, &#39;help&#39;, &#39;in&#39;, &#39;their&#39;, &#39;restoration&#39;, &#39;It&#39;, &#39;is&#39;, &#39;not&#39;, &#39;a&#39;, &#39;simple&#39;, &#39;task&#39;, &#39;as&#39;, &#39;he&#39;, &#39;quickly&#39;, &#39;finds&#39;, &#39;outbr&#39;, &#39;br&#39;, &#39;His&#39;, &#39;uncle&#39;, &#39;finds&#39;, &#39;him&#39;, &#39;a&#39;, &#39;job&#39;, &#39;as&#39;, &#39;a&#39;, &#39;night&#39;, &#39;conductor&#39;, &#39;on&#39;, &#39;the&#39;, &#39;Zentropa&#39;, &#39;Railway&#39;, &#39;Line&#39;, &#39;His&#39;, &#39;job&#39;, &#39;is&#39;, &#39;to&#39;, &#39;attend&#39;, &#39;to&#39;, &#39;the&#39;, &#39;needs&#39;, &#39;of&#39;, &#39;the&#39;, &#39;passengers&#39;, &#39;When&#39;, &#39;the&#39;, &#39;shoes&#39;, &#39;are&#39;, &#39;polished&#39;, &#39;a&#39;, &#39;chalk&#39;, &#39;mark&#39;, &#39;is&#39;, &#39;made&#39;, &#39;on&#39;, &#39;the&#39;, &#39;soles&#39;, &#39;A&#39;, &#39;terrible&#39;, &#39;argument&#39;, &#39;ensues&#39;, &#39;when&#39;, &#39;a&#39;, &#39;passengers&#39;, &#39;shoes&#39;, &#39;are&#39;, &#39;not&#39;, &#39;chalked&#39;, &#39;despite&#39;, &#39;the&#39;, &#39;fact&#39;, &#39;they&#39;, &#39;have&#39;, &#39;been&#39;, &#39;polished&#39;, &#39;There&#39;, &#39;are&#39;, &#39;many&#39;, &#39;allusions&#39;, &#39;to&#39;, &#39;the&#39;, &#39;German&#39;, &#39;fanaticism&#39;, &#39;of&#39;, &#39;adherence&#39;, &#39;to&#39;, &#39;such&#39;, &#39;stupid&#39;, &#39;detailsbr&#39;, &#39;br&#39;, &#39;The&#39;, &#39;railway&#39;, &#39;journey&#39;, &#39;is&#39;, &#39;like&#39;, &#39;an&#39;, &#39;allegory&#39;, &#39;representing&#39;, &#39;mans&#39;, &#39;procession&#39;, &#39;through&#39;, &#39;life&#39;, &#39;with&#39;, &#39;all&#39;, &#39;its&#39;, &#39;trials&#39;, &#39;and&#39;, &#39;tribulations&#39;, &#39;In&#39;, &#39;one&#39;, &#39;sequence&#39;, &#39;Leo&#39;, &#39;dashes&#39;, &#39;through&#39;, &#39;the&#39;, &#39;back&#39;, &#39;carriages&#39;, &#39;to&#39;, &#39;discover&#39;, &#39;them&#39;, &#39;filled&#39;, &#39;with&#39;, &#39;halfstarved&#39;, &#39;bodies&#39;, &#39;appearing&#39;, &#39;to&#39;, &#39;have&#39;, &#39;just&#39;, &#39;escaped&#39;, &#39;from&#39;, &#39;Auschwitz&#39;, &#39;These&#39;, &#39;images&#39;, &#39;horrible&#39;, &#39;as&#39;, &#39;they&#39;, &#39;are&#39;, &#39;are&#39;, &#39;fleeting&#39;, &#39;as&#39;, &#39;in&#39;, &#39;a&#39;, &#39;dream&#39;, &#39;each&#39;, &#39;with&#39;, &#39;its&#39;, &#39;own&#39;, &#39;terrible&#39;, &#39;impact&#39;, &#39;yet&#39;, &#39;unconnectedbr&#39;, &#39;br&#39;, &#39;At&#39;, &#39;a&#39;, &#39;station&#39;, &#39;called&#39;, &#39;Urmitz&#39;, &#39;Leo&#39;, &#39;jumps&#39;, &#39;from&#39;, &#39;the&#39;, &#39;train&#39;, &#39;with&#39;, &#39;a&#39;, &#39;parceled&#39;, &#39;bomb&#39;, &#39;In&#39;, &#39;view&#39;, &#39;of&#39;, &#39;many&#39;, &#39;bystanders&#39;, &#39;he&#39;, &#39;connects&#39;, &#39;the&#39;, &#39;bomb&#39;, &#39;to&#39;, &#39;the&#39;, &#39;underside&#39;, &#39;of&#39;, &#39;a&#39;, &#39;carriage&#39;, &#39;He&#39;, &#39;returns&#39;, &#39;to&#39;, &#39;his&#39;, &#39;cabin&#39;, &#39;and&#39;, &#39;makes&#39;, &#39;a&#39;, &#39;connection&#39;, &#39;to&#39;, &#39;a&#39;, &#39;time&#39;, &#39;clock&#39;, &#39;Later&#39;, &#39;he&#39;, &#39;jumps&#39;, &#39;from&#39;, &#39;the&#39;, &#39;train&#39;, &#39;at&#39;, &#39;high&#39;, &#39;speed&#39;, &#39;and&#39;, &#39;lies&#39;, &#39;in&#39;, &#39;the&#39;, &#39;cool&#39;, &#39;grass&#39;, &#39;on&#39;, &#39;a&#39;, &#39;river&#39;, &#39;bank&#39;, &#39;Looking&#39;, &#39;at&#39;, &#39;the&#39;, &#39;stars&#39;, &#39;above&#39;, &#39;he&#39;, &#39;decides&#39;, &#39;that&#39;, &#39;his&#39;, &#39;job&#39;, &#39;is&#39;, &#39;to&#39;, &#39;build&#39;, &#39;and&#39;, &#39;not&#39;, &#39;destroy&#39;, &#39;Subsequently&#39;, &#39;as&#39;, &#39;he&#39;, &#39;sees&#39;, &#39;the&#39;, &#39;train&#39;, &#39;approaching&#39;, &#39;a&#39;, &#39;giant&#39;, &#39;bridge&#39;, &#39;he&#39;, &#39;runs&#39;, &#39;at&#39;, &#39;breakneck&#39;, &#39;speed&#39;, &#39;to&#39;, &#39;board&#39;, &#39;the&#39;, &#39;train&#39;, &#39;and&#39;, &#39;stop&#39;, &#39;the&#39;, &#39;clock&#39;, &#39;If&#39;, &#39;you&#39;, &#39;care&#39;, &#39;to&#39;, &#39;analyse&#39;, &#39;the&#39;, &#39;situation&#39;, &#39;it&#39;, &#39;is&#39;, &#39;a&#39;, &#39;completely&#39;, &#39;impossible&#39;, &#39;task&#39;, &#39;Quite&#39;, &#39;ridiculous&#39;, &#39;in&#39;, &#39;fact&#39;, &#39;It&#39;, &#39;could&#39;, &#39;only&#39;, &#39;happen&#39;, &#39;in&#39;, &#39;a&#39;, &#39;dreambr&#39;, &#39;br&#39;, &#39;Its&#39;, &#39;strange&#39;, &#39;how&#39;, &#39;one&#39;, &#39;remembers&#39;, &#39;little&#39;, &#39;details&#39;, &#39;such&#39;, &#39;as&#39;, &#39;a&#39;, &#39;row&#39;, &#39;of&#39;, &#39;cups&#39;, &#39;hanging&#39;, &#39;on&#39;, &#39;hooks&#39;, &#39;and&#39;, &#39;rattling&#39;, &#39;away&#39;, &#39;with&#39;, &#39;the&#39;, &#39;swaying&#39;, &#39;of&#39;, &#39;the&#39;, &#39;trainbr&#39;, &#39;br&#39;, &#39;Despite&#39;, &#39;the&#39;, &#39;fact&#39;, &#39;that&#39;, &#39;this&#39;, &#39;film&#39;, &#39;is&#39;, &#39;widely&#39;, &#39;acclaimed&#39;, &#39;I&#39;, &#39;prefer&#39;, &#39;Lars&#39;, &#39;Von&#39;, &#39;Triers&#39;, &#39;later&#39;, &#39;films&#39;, &#39;Breaking&#39;, &#39;the&#39;, &#39;Waves&#39;, &#39;and&#39;, &#39;The&#39;, &#39;Idiots&#39;, &#39;The&#39;, &#39;bomb&#39;, &#39;scene&#39;, &#39;described&#39;, &#39;above&#39;, &#39;really&#39;, &#39;put&#39;, &#39;me&#39;, &#39;off&#39;, &#39;Perhaps&#39;, &#39;Im&#39;, &#39;a&#39;, &#39;realist&#39;]}
{&#39;id&#39;: 12503, &#39;text&#39;: &#39;*Contains spoilers due to me having to describe some film techniques, so read at your own risk!*&lt;br /&gt;&lt;br /&gt;I loved this film. The use of tinting in some of the scenes makes it seem like an old photograph come to life. I also enjoyed the projection of people on a back screen. For instance, in one scene, Leopold calls his wife and she is projected behind him rather than in a typical split screen. Her face is huge in the back and Leo\&#39;s is in the foreground.&lt;br /&gt;&lt;br /&gt;One of the best uses of this is when the young boys kill the Ravensteins on the train, a scene shot in an almost political poster style, with facial close ups. It reminded me of Battleship Potemkin, that intense constant style coupled with the spray of red to convey tons of horror without much gore. Same with the scene when Katharina finds her father dead in the bathtub...you can only see the red water on the side. It is one of the things I love about Von Trier, his understatement of horror, which ends up making it all the more creepy.&lt;br /&gt;&lt;br /&gt;The use of text in the film was unique, like when Leo\&#39;s character is pushed by the word, &quot;Werewolf.&quot; I have never seen anything like that in a film.&lt;br /&gt;&lt;br /&gt;The use of black comedy in this film was well done. Ernst-Hugo J√§reg√•rd is great as Leo\&#39;s uncle. It brings up the snickers I got from his role in the Kingdom (Riget.) This humor makes the plotline of absurd anal retentiveness of train conductors against the terrible backdrop of WW2 and all the chaos, easier to take. It reminds me of Riget in the way the hospital administrator is trying to maintain a normalcy at the end of part one when everything is going crazy. It shows that some people are truly oblivious to the awful things happening around them. Yet some people, like Leo, are tuned in, but do nothing positive about it.&lt;br /&gt;&lt;br /&gt;The voice over, done expertly well by Max von Sydow, is amusing too. It draws you into the story and makes you jump into Leo\&#39;s head, which at times is a scary place to be.&lt;br /&gt;&lt;br /&gt;The movie brings up the point that one is a coward if they don\&#39;t choose a side. I see the same idea used in Dancer in the Dark, where Bjork\&#39;s character doesn\&#39;t speak up for herself and ends up being her own destruction. Actually, at one time, Von Trier seemed anti-woman to me, by making Breaking the Waves and Dancer, but now I know his male characters don\&#39;t fare well either! I found myself at the same place during the end of Dancer, when you seriously want the main character to rethink their actions, but of course, they never do!&#39;, &#39;label&#39;: 1, &#39;text_tokenized&#39;: [&#39;Contains&#39;, &#39;spoilers&#39;, &#39;due&#39;, &#39;to&#39;, &#39;me&#39;, &#39;having&#39;, &#39;to&#39;, &#39;describe&#39;, &#39;some&#39;, &#39;film&#39;, &#39;techniques&#39;, &#39;so&#39;, &#39;read&#39;, &#39;at&#39;, &#39;your&#39;, &#39;own&#39;, &#39;riskbr&#39;, &#39;br&#39;, &#39;I&#39;, &#39;loved&#39;, &#39;this&#39;, &#39;film&#39;, &#39;The&#39;, &#39;use&#39;, &#39;of&#39;, &#39;tinting&#39;, &#39;in&#39;, &#39;some&#39;, &#39;of&#39;, &#39;the&#39;, &#39;scenes&#39;, &#39;makes&#39;, &#39;it&#39;, &#39;seem&#39;, &#39;like&#39;, &#39;an&#39;, &#39;old&#39;, &#39;photograph&#39;, &#39;come&#39;, &#39;to&#39;, &#39;life&#39;, &#39;I&#39;, &#39;also&#39;, &#39;enjoyed&#39;, &#39;the&#39;, &#39;projection&#39;, &#39;of&#39;, &#39;people&#39;, &#39;on&#39;, &#39;a&#39;, &#39;back&#39;, &#39;screen&#39;, &#39;For&#39;, &#39;instance&#39;, &#39;in&#39;, &#39;one&#39;, &#39;scene&#39;, &#39;Leopold&#39;, &#39;calls&#39;, &#39;his&#39;, &#39;wife&#39;, &#39;and&#39;, &#39;she&#39;, &#39;is&#39;, &#39;projected&#39;, &#39;behind&#39;, &#39;him&#39;, &#39;rather&#39;, &#39;than&#39;, &#39;in&#39;, &#39;a&#39;, &#39;typical&#39;, &#39;split&#39;, &#39;screen&#39;, &#39;Her&#39;, &#39;face&#39;, &#39;is&#39;, &#39;huge&#39;, &#39;in&#39;, &#39;the&#39;, &#39;back&#39;, &#39;and&#39;, &#39;Leos&#39;, &#39;is&#39;, &#39;in&#39;, &#39;the&#39;, &#39;foregroundbr&#39;, &#39;br&#39;, &#39;One&#39;, &#39;of&#39;, &#39;the&#39;, &#39;best&#39;, &#39;uses&#39;, &#39;of&#39;, &#39;this&#39;, &#39;is&#39;, &#39;when&#39;, &#39;the&#39;, &#39;young&#39;, &#39;boys&#39;, &#39;kill&#39;, &#39;the&#39;, &#39;Ravensteins&#39;, &#39;on&#39;, &#39;the&#39;, &#39;train&#39;, &#39;a&#39;, &#39;scene&#39;, &#39;shot&#39;, &#39;in&#39;, &#39;an&#39;, &#39;almost&#39;, &#39;political&#39;, &#39;poster&#39;, &#39;style&#39;, &#39;with&#39;, &#39;facial&#39;, &#39;close&#39;, &#39;ups&#39;, &#39;It&#39;, &#39;reminded&#39;, &#39;me&#39;, &#39;of&#39;, &#39;Battleship&#39;, &#39;Potemkin&#39;, &#39;that&#39;, &#39;intense&#39;, &#39;constant&#39;, &#39;style&#39;, &#39;coupled&#39;, &#39;with&#39;, &#39;the&#39;, &#39;spray&#39;, &#39;of&#39;, &#39;red&#39;, &#39;to&#39;, &#39;convey&#39;, &#39;tons&#39;, &#39;of&#39;, &#39;horror&#39;, &#39;without&#39;, &#39;much&#39;, &#39;gore&#39;, &#39;Same&#39;, &#39;with&#39;, &#39;the&#39;, &#39;scene&#39;, &#39;when&#39;, &#39;Katharina&#39;, &#39;finds&#39;, &#39;her&#39;, &#39;father&#39;, &#39;dead&#39;, &#39;in&#39;, &#39;the&#39;, &#39;bathtubyou&#39;, &#39;can&#39;, &#39;only&#39;, &#39;see&#39;, &#39;the&#39;, &#39;red&#39;, &#39;water&#39;, &#39;on&#39;, &#39;the&#39;, &#39;side&#39;, &#39;It&#39;, &#39;is&#39;, &#39;one&#39;, &#39;of&#39;, &#39;the&#39;, &#39;things&#39;, &#39;I&#39;, &#39;love&#39;, &#39;about&#39;, &#39;Von&#39;, &#39;Trier&#39;, &#39;his&#39;, &#39;understatement&#39;, &#39;of&#39;, &#39;horror&#39;, &#39;which&#39;, &#39;ends&#39;, &#39;up&#39;, &#39;making&#39;, &#39;it&#39;, &#39;all&#39;, &#39;the&#39;, &#39;more&#39;, &#39;creepybr&#39;, &#39;br&#39;, &#39;The&#39;, &#39;use&#39;, &#39;of&#39;, &#39;text&#39;, &#39;in&#39;, &#39;the&#39;, &#39;film&#39;, &#39;was&#39;, &#39;unique&#39;, &#39;like&#39;, &#39;when&#39;, &#39;Leos&#39;, &#39;character&#39;, &#39;is&#39;, &#39;pushed&#39;, &#39;by&#39;, &#39;the&#39;, &#39;word&#39;, &#39;Werewolf&#39;, &#39;I&#39;, &#39;have&#39;, &#39;never&#39;, &#39;seen&#39;, &#39;anything&#39;, &#39;like&#39;, &#39;that&#39;, &#39;in&#39;, &#39;a&#39;, &#39;filmbr&#39;, &#39;br&#39;, &#39;The&#39;, &#39;use&#39;, &#39;of&#39;, &#39;black&#39;, &#39;comedy&#39;, &#39;in&#39;, &#39;this&#39;, &#39;film&#39;, &#39;was&#39;, &#39;well&#39;, &#39;done&#39;, &#39;ErnstHugo&#39;, &#39;J√§reg√•rd&#39;, &#39;is&#39;, &#39;great&#39;, &#39;as&#39;, &#39;Leos&#39;, &#39;uncle&#39;, &#39;It&#39;, &#39;brings&#39;, &#39;up&#39;, &#39;the&#39;, &#39;snickers&#39;, &#39;I&#39;, &#39;got&#39;, &#39;from&#39;, &#39;his&#39;, &#39;role&#39;, &#39;in&#39;, &#39;the&#39;, &#39;Kingdom&#39;, &#39;Riget&#39;, &#39;This&#39;, &#39;humor&#39;, &#39;makes&#39;, &#39;the&#39;, &#39;plotline&#39;, &#39;of&#39;, &#39;absurd&#39;, &#39;anal&#39;, &#39;retentiveness&#39;, &#39;of&#39;, &#39;train&#39;, &#39;conductors&#39;, &#39;against&#39;, &#39;the&#39;, &#39;terrible&#39;, &#39;backdrop&#39;, &#39;of&#39;, &#39;WW2&#39;, &#39;and&#39;, &#39;all&#39;, &#39;the&#39;, &#39;chaos&#39;, &#39;easier&#39;, &#39;to&#39;, &#39;take&#39;, &#39;It&#39;, &#39;reminds&#39;, &#39;me&#39;, &#39;of&#39;, &#39;Riget&#39;, &#39;in&#39;, &#39;the&#39;, &#39;way&#39;, &#39;the&#39;, &#39;hospital&#39;, &#39;administrator&#39;, &#39;is&#39;, &#39;trying&#39;, &#39;to&#39;, &#39;maintain&#39;, &#39;a&#39;, &#39;normalcy&#39;, &#39;at&#39;, &#39;the&#39;, &#39;end&#39;, &#39;of&#39;, &#39;part&#39;, &#39;one&#39;, &#39;when&#39;, &#39;everything&#39;, &#39;is&#39;, &#39;going&#39;, &#39;crazy&#39;, &#39;It&#39;, &#39;shows&#39;, &#39;that&#39;, &#39;some&#39;, &#39;people&#39;, &#39;are&#39;, &#39;truly&#39;, &#39;oblivious&#39;, &#39;to&#39;, &#39;the&#39;, &#39;awful&#39;, &#39;things&#39;, &#39;happening&#39;, &#39;around&#39;, &#39;them&#39;, &#39;Yet&#39;, &#39;some&#39;, &#39;people&#39;, &#39;like&#39;, &#39;Leo&#39;, &#39;are&#39;, &#39;tuned&#39;, &#39;in&#39;, &#39;but&#39;, &#39;do&#39;, &#39;nothing&#39;, &#39;positive&#39;, &#39;about&#39;, &#39;itbr&#39;, &#39;br&#39;, &#39;The&#39;, &#39;voice&#39;, &#39;over&#39;, &#39;done&#39;, &#39;expertly&#39;, &#39;well&#39;, &#39;by&#39;, &#39;Max&#39;, &#39;von&#39;, &#39;Sydow&#39;, &#39;is&#39;, &#39;amusing&#39;, &#39;too&#39;, &#39;It&#39;, &#39;draws&#39;, &#39;you&#39;, &#39;into&#39;, &#39;the&#39;, &#39;story&#39;, &#39;and&#39;, &#39;makes&#39;, &#39;you&#39;, &#39;jump&#39;, &#39;into&#39;, &#39;Leos&#39;, &#39;head&#39;, &#39;which&#39;, &#39;at&#39;, &#39;times&#39;, &#39;is&#39;, &#39;a&#39;, &#39;scary&#39;, &#39;place&#39;, &#39;to&#39;, &#39;bebr&#39;, &#39;br&#39;, &#39;The&#39;, &#39;movie&#39;, &#39;brings&#39;, &#39;up&#39;, &#39;the&#39;, &#39;point&#39;, &#39;that&#39;, &#39;one&#39;, &#39;is&#39;, &#39;a&#39;, &#39;coward&#39;, &#39;if&#39;, &#39;they&#39;, &#39;dont&#39;, &#39;choose&#39;, &#39;a&#39;, &#39;side&#39;, &#39;I&#39;, &#39;see&#39;, &#39;the&#39;, &#39;same&#39;, &#39;idea&#39;, &#39;used&#39;, &#39;in&#39;, &#39;Dancer&#39;, &#39;in&#39;, &#39;the&#39;, &#39;Dark&#39;, &#39;where&#39;, &#39;Bjorks&#39;, &#39;character&#39;, &#39;doesnt&#39;, &#39;speak&#39;, &#39;up&#39;, &#39;for&#39;, &#39;herself&#39;, &#39;and&#39;, &#39;ends&#39;, &#39;up&#39;, &#39;being&#39;, &#39;her&#39;, &#39;own&#39;, &#39;destruction&#39;, &#39;Actually&#39;, &#39;at&#39;, &#39;one&#39;, &#39;time&#39;, &#39;Von&#39;, &#39;Trier&#39;, &#39;seemed&#39;, &#39;antiwoman&#39;, &#39;to&#39;, &#39;me&#39;, &#39;by&#39;, &#39;making&#39;, &#39;Breaking&#39;, &#39;the&#39;, &#39;Waves&#39;, &#39;and&#39;, &#39;Dancer&#39;, &#39;but&#39;, &#39;now&#39;, &#39;I&#39;, &#39;know&#39;, &#39;his&#39;, &#39;male&#39;, &#39;characters&#39;, &#39;dont&#39;, &#39;fare&#39;, &#39;well&#39;, &#39;either&#39;, &#39;I&#39;, &#39;found&#39;, &#39;myself&#39;, &#39;at&#39;, &#39;the&#39;, &#39;same&#39;, &#39;place&#39;, &#39;during&#39;, &#39;the&#39;, &#39;end&#39;, &#39;of&#39;, &#39;Dancer&#39;, &#39;when&#39;, &#39;you&#39;, &#39;seriously&#39;, &#39;want&#39;, &#39;the&#39;, &#39;main&#39;, &#39;character&#39;, &#39;to&#39;, &#39;rethink&#39;, &#39;their&#39;, &#39;actions&#39;, &#39;but&#39;, &#39;of&#39;, &#39;course&#39;, &#39;they&#39;, &#39;never&#39;, &#39;do&#39;]}
{&#39;id&#39;: 12504, &#39;text&#39;: &quot;That was the first thing that sprang to mind as I watched the closing credits to Europa make there was across the screen, never in my entire life have I seen a film of such technical genius, the visuals of Europa are so impressive that any film I watch in it&#39;s wake will only pale in comparison, forget your Michael Bay, Ridley Scott slick Hollywood cinematography, Europa has more ethereal beauty than anything those two could conjure up in a million years. Now I&#39;d be the first to hail Lars von Trier a genius just off the back of his films Breaking the Waves and Dancer in the Dark, but this is stupid, the fact that Europa has gone un-noticed by film experts for so long is a crime against cinema, whilst overrated rubbish like Crouching Tiger, Hidden Dragon and Life is Beautiful clean up at the academy awards (but what do the know) Europa has been hidden away, absent form video stores and (until recently) any British TV channels. &lt;br /&gt;&lt;br /&gt;The visuals in Europa are not MTV gloss; it&#39;s not a case of style over substance, its more a case of substance dictating style. Much like his first film The Element of Crime, von Trier uses the perspective of the main character to draw us into his world, and much like Element, the film begins with the main character (or in the case of Europa, we the audience) being hypnotized. As we move down the tracks, the voice of the Narrator (Max von Sydow) counts us down into a deep sleep, until we awake in Europa. This allows von Trier and his three cinematographers to pay with the conventions of time and imagery, there are many scenes in Europa when a character in the background, who is in black and white, will interact with a person in the foreground who will be colour, von Trier is trying to show us how much precedence the coloured item or person has over the plot, for instance, it&#39;s no surprise that the first shot of Leopold Kessler (Jean-marc Barr) is in colour, since he is the only character who&#39;s actions have superiority over the film. &lt;br /&gt;&lt;br /&gt;The performances are good, they may not be on par with performances in later von Trier films, but that&#39;s just because the images are sometimes so distracting that you don&#39;t really pick up on them the first time round. But I would like to point out the fantastic performance of Jean-Marc Barr in the lead role, whose blind idealism is slowly warn down by the two opposing sides, until he erupts in the films final act. Again, muck like The Element of Crime, the film ends with our hero unable to wake up from his nightmare state, left in this terrible place, with only the continuing narration of von Sydow to seal his fate. Europa is a tremendous film, and I cant help thinking what a shame that von Trier has abandoned this way of filming, since he was clearly one of the most talented visual directors working at that time, Europa, much like the rest of his cinematic cannon is filled with a wealth of iconic scenes. His dedication to composition and mise-en-scene is unrivalled, not to mention his use of sound and production design. But since his no-frills melodramas turned out to be Breaking the Waves and Dancer in the Dark then who can argue, but it does seems like a waste of an imaginative talent. 10/10&quot;, &#39;label&#39;: 1, &#39;text_tokenized&#39;: [&#39;That&#39;, &#39;was&#39;, &#39;the&#39;, &#39;first&#39;, &#39;thing&#39;, &#39;that&#39;, &#39;sprang&#39;, &#39;to&#39;, &#39;mind&#39;, &#39;as&#39;, &#39;I&#39;, &#39;watched&#39;, &#39;the&#39;, &#39;closing&#39;, &#39;credits&#39;, &#39;to&#39;, &#39;Europa&#39;, &#39;make&#39;, &#39;there&#39;, &#39;was&#39;, &#39;across&#39;, &#39;the&#39;, &#39;screen&#39;, &#39;never&#39;, &#39;in&#39;, &#39;my&#39;, &#39;entire&#39;, &#39;life&#39;, &#39;have&#39;, &#39;I&#39;, &#39;seen&#39;, &#39;a&#39;, &#39;film&#39;, &#39;of&#39;, &#39;such&#39;, &#39;technical&#39;, &#39;genius&#39;, &#39;the&#39;, &#39;visuals&#39;, &#39;of&#39;, &#39;Europa&#39;, &#39;are&#39;, &#39;so&#39;, &#39;impressive&#39;, &#39;that&#39;, &#39;any&#39;, &#39;film&#39;, &#39;I&#39;, &#39;watch&#39;, &#39;in&#39;, &#39;its&#39;, &#39;wake&#39;, &#39;will&#39;, &#39;only&#39;, &#39;pale&#39;, &#39;in&#39;, &#39;comparison&#39;, &#39;forget&#39;, &#39;your&#39;, &#39;Michael&#39;, &#39;Bay&#39;, &#39;Ridley&#39;, &#39;Scott&#39;, &#39;slick&#39;, &#39;Hollywood&#39;, &#39;cinematography&#39;, &#39;Europa&#39;, &#39;has&#39;, &#39;more&#39;, &#39;ethereal&#39;, &#39;beauty&#39;, &#39;than&#39;, &#39;anything&#39;, &#39;those&#39;, &#39;two&#39;, &#39;could&#39;, &#39;conjure&#39;, &#39;up&#39;, &#39;in&#39;, &#39;a&#39;, &#39;million&#39;, &#39;years&#39;, &#39;Now&#39;, &#39;Id&#39;, &#39;be&#39;, &#39;the&#39;, &#39;first&#39;, &#39;to&#39;, &#39;hail&#39;, &#39;Lars&#39;, &#39;von&#39;, &#39;Trier&#39;, &#39;a&#39;, &#39;genius&#39;, &#39;just&#39;, &#39;off&#39;, &#39;the&#39;, &#39;back&#39;, &#39;of&#39;, &#39;his&#39;, &#39;films&#39;, &#39;Breaking&#39;, &#39;the&#39;, &#39;Waves&#39;, &#39;and&#39;, &#39;Dancer&#39;, &#39;in&#39;, &#39;the&#39;, &#39;Dark&#39;, &#39;but&#39;, &#39;this&#39;, &#39;is&#39;, &#39;stupid&#39;, &#39;the&#39;, &#39;fact&#39;, &#39;that&#39;, &#39;Europa&#39;, &#39;has&#39;, &#39;gone&#39;, &#39;unnoticed&#39;, &#39;by&#39;, &#39;film&#39;, &#39;experts&#39;, &#39;for&#39;, &#39;so&#39;, &#39;long&#39;, &#39;is&#39;, &#39;a&#39;, &#39;crime&#39;, &#39;against&#39;, &#39;cinema&#39;, &#39;whilst&#39;, &#39;overrated&#39;, &#39;rubbish&#39;, &#39;like&#39;, &#39;Crouching&#39;, &#39;Tiger&#39;, &#39;Hidden&#39;, &#39;Dragon&#39;, &#39;and&#39;, &#39;Life&#39;, &#39;is&#39;, &#39;Beautiful&#39;, &#39;clean&#39;, &#39;up&#39;, &#39;at&#39;, &#39;the&#39;, &#39;academy&#39;, &#39;awards&#39;, &#39;but&#39;, &#39;what&#39;, &#39;do&#39;, &#39;the&#39;, &#39;know&#39;, &#39;Europa&#39;, &#39;has&#39;, &#39;been&#39;, &#39;hidden&#39;, &#39;away&#39;, &#39;absent&#39;, &#39;form&#39;, &#39;video&#39;, &#39;stores&#39;, &#39;and&#39;, &#39;until&#39;, &#39;recently&#39;, &#39;any&#39;, &#39;British&#39;, &#39;TV&#39;, &#39;channels&#39;, &#39;br&#39;, &#39;br&#39;, &#39;The&#39;, &#39;visuals&#39;, &#39;in&#39;, &#39;Europa&#39;, &#39;are&#39;, &#39;not&#39;, &#39;MTV&#39;, &#39;gloss&#39;, &#39;its&#39;, &#39;not&#39;, &#39;a&#39;, &#39;case&#39;, &#39;of&#39;, &#39;style&#39;, &#39;over&#39;, &#39;substance&#39;, &#39;its&#39;, &#39;more&#39;, &#39;a&#39;, &#39;case&#39;, &#39;of&#39;, &#39;substance&#39;, &#39;dictating&#39;, &#39;style&#39;, &#39;Much&#39;, &#39;like&#39;, &#39;his&#39;, &#39;first&#39;, &#39;film&#39;, &#39;The&#39;, &#39;Element&#39;, &#39;of&#39;, &#39;Crime&#39;, &#39;von&#39;, &#39;Trier&#39;, &#39;uses&#39;, &#39;the&#39;, &#39;perspective&#39;, &#39;of&#39;, &#39;the&#39;, &#39;main&#39;, &#39;character&#39;, &#39;to&#39;, &#39;draw&#39;, &#39;us&#39;, &#39;into&#39;, &#39;his&#39;, &#39;world&#39;, &#39;and&#39;, &#39;much&#39;, &#39;like&#39;, &#39;Element&#39;, &#39;the&#39;, &#39;film&#39;, &#39;begins&#39;, &#39;with&#39;, &#39;the&#39;, &#39;main&#39;, &#39;character&#39;, &#39;or&#39;, &#39;in&#39;, &#39;the&#39;, &#39;case&#39;, &#39;of&#39;, &#39;Europa&#39;, &#39;we&#39;, &#39;the&#39;, &#39;audience&#39;, &#39;being&#39;, &#39;hypnotized&#39;, &#39;As&#39;, &#39;we&#39;, &#39;move&#39;, &#39;down&#39;, &#39;the&#39;, &#39;tracks&#39;, &#39;the&#39;, &#39;voice&#39;, &#39;of&#39;, &#39;the&#39;, &#39;Narrator&#39;, &#39;Max&#39;, &#39;von&#39;, &#39;Sydow&#39;, &#39;counts&#39;, &#39;us&#39;, &#39;down&#39;, &#39;into&#39;, &#39;a&#39;, &#39;deep&#39;, &#39;sleep&#39;, &#39;until&#39;, &#39;we&#39;, &#39;awake&#39;, &#39;in&#39;, &#39;Europa&#39;, &#39;This&#39;, &#39;allows&#39;, &#39;von&#39;, &#39;Trier&#39;, &#39;and&#39;, &#39;his&#39;, &#39;three&#39;, &#39;cinematographers&#39;, &#39;to&#39;, &#39;pay&#39;, &#39;with&#39;, &#39;the&#39;, &#39;conventions&#39;, &#39;of&#39;, &#39;time&#39;, &#39;and&#39;, &#39;imagery&#39;, &#39;there&#39;, &#39;are&#39;, &#39;many&#39;, &#39;scenes&#39;, &#39;in&#39;, &#39;Europa&#39;, &#39;when&#39;, &#39;a&#39;, &#39;character&#39;, &#39;in&#39;, &#39;the&#39;, &#39;background&#39;, &#39;who&#39;, &#39;is&#39;, &#39;in&#39;, &#39;black&#39;, &#39;and&#39;, &#39;white&#39;, &#39;will&#39;, &#39;interact&#39;, &#39;with&#39;, &#39;a&#39;, &#39;person&#39;, &#39;in&#39;, &#39;the&#39;, &#39;foreground&#39;, &#39;who&#39;, &#39;will&#39;, &#39;be&#39;, &#39;colour&#39;, &#39;von&#39;, &#39;Trier&#39;, &#39;is&#39;, &#39;trying&#39;, &#39;to&#39;, &#39;show&#39;, &#39;us&#39;, &#39;how&#39;, &#39;much&#39;, &#39;precedence&#39;, &#39;the&#39;, &#39;coloured&#39;, &#39;item&#39;, &#39;or&#39;, &#39;person&#39;, &#39;has&#39;, &#39;over&#39;, &#39;the&#39;, &#39;plot&#39;, &#39;for&#39;, &#39;instance&#39;, &#39;its&#39;, &#39;no&#39;, &#39;surprise&#39;, &#39;that&#39;, &#39;the&#39;, &#39;first&#39;, &#39;shot&#39;, &#39;of&#39;, &#39;Leopold&#39;, &#39;Kessler&#39;, &#39;Jeanmarc&#39;, &#39;Barr&#39;, &#39;is&#39;, &#39;in&#39;, &#39;colour&#39;, &#39;since&#39;, &#39;he&#39;, &#39;is&#39;, &#39;the&#39;, &#39;only&#39;, &#39;character&#39;, &#39;whos&#39;, &#39;actions&#39;, &#39;have&#39;, &#39;superiority&#39;, &#39;over&#39;, &#39;the&#39;, &#39;film&#39;, &#39;br&#39;, &#39;br&#39;, &#39;The&#39;, &#39;performances&#39;, &#39;are&#39;, &#39;good&#39;, &#39;they&#39;, &#39;may&#39;, &#39;not&#39;, &#39;be&#39;, &#39;on&#39;, &#39;par&#39;, &#39;with&#39;, &#39;performances&#39;, &#39;in&#39;, &#39;later&#39;, &#39;von&#39;, &#39;Trier&#39;, &#39;films&#39;, &#39;but&#39;, &#39;thats&#39;, &#39;just&#39;, &#39;because&#39;, &#39;the&#39;, &#39;images&#39;, &#39;are&#39;, &#39;sometimes&#39;, &#39;so&#39;, &#39;distracting&#39;, &#39;that&#39;, &#39;you&#39;, &#39;dont&#39;, &#39;really&#39;, &#39;pick&#39;, &#39;up&#39;, &#39;on&#39;, &#39;them&#39;, &#39;the&#39;, &#39;first&#39;, &#39;time&#39;, &#39;round&#39;, &#39;But&#39;, &#39;I&#39;, &#39;would&#39;, &#39;like&#39;, &#39;to&#39;, &#39;point&#39;, &#39;out&#39;, &#39;the&#39;, &#39;fantastic&#39;, &#39;performance&#39;, &#39;of&#39;, &#39;JeanMarc&#39;, &#39;Barr&#39;, &#39;in&#39;, &#39;the&#39;, &#39;lead&#39;, &#39;role&#39;, &#39;whose&#39;, &#39;blind&#39;, &#39;idealism&#39;, &#39;is&#39;, &#39;slowly&#39;, &#39;warn&#39;, &#39;down&#39;, &#39;by&#39;, &#39;the&#39;, &#39;two&#39;, &#39;opposing&#39;, &#39;sides&#39;, &#39;until&#39;, &#39;he&#39;, &#39;erupts&#39;, &#39;in&#39;, &#39;the&#39;, &#39;films&#39;, &#39;final&#39;, &#39;act&#39;, &#39;Again&#39;, &#39;muck&#39;, &#39;like&#39;, &#39;The&#39;, &#39;Element&#39;, &#39;of&#39;, &#39;Crime&#39;, &#39;the&#39;, &#39;film&#39;, &#39;ends&#39;, &#39;with&#39;, &#39;our&#39;, &#39;hero&#39;, &#39;unable&#39;, &#39;to&#39;, &#39;wake&#39;, &#39;up&#39;, &#39;from&#39;, &#39;his&#39;, &#39;nightmare&#39;, &#39;state&#39;, &#39;left&#39;, &#39;in&#39;, &#39;this&#39;, &#39;terrible&#39;, &#39;place&#39;, &#39;with&#39;, &#39;only&#39;, &#39;the&#39;, &#39;continuing&#39;, &#39;narration&#39;, &#39;of&#39;, &#39;von&#39;, &#39;Sydow&#39;, &#39;to&#39;, &#39;seal&#39;, &#39;his&#39;, &#39;fate&#39;, &#39;Europa&#39;, &#39;is&#39;, &#39;a&#39;, &#39;tremendous&#39;, &#39;film&#39;, &#39;and&#39;, &#39;I&#39;, &#39;cant&#39;, &#39;help&#39;, &#39;thinking&#39;, &#39;what&#39;, &#39;a&#39;, &#39;shame&#39;, &#39;that&#39;, &#39;von&#39;, &#39;Trier&#39;, &#39;has&#39;, &#39;abandoned&#39;, &#39;this&#39;, &#39;way&#39;, &#39;of&#39;, &#39;filming&#39;, &#39;since&#39;, &#39;he&#39;, &#39;was&#39;, &#39;clearly&#39;, &#39;one&#39;, &#39;of&#39;, &#39;the&#39;, &#39;most&#39;, &#39;talented&#39;, &#39;visual&#39;, &#39;directors&#39;, &#39;working&#39;, &#39;at&#39;, &#39;that&#39;, &#39;time&#39;, &#39;Europa&#39;, &#39;much&#39;, &#39;like&#39;, &#39;the&#39;, &#39;rest&#39;, &#39;of&#39;, &#39;his&#39;, &#39;cinematic&#39;, &#39;cannon&#39;, &#39;is&#39;, &#39;filled&#39;, &#39;with&#39;, &#39;a&#39;, &#39;wealth&#39;, &#39;of&#39;, &#39;iconic&#39;, &#39;scenes&#39;, &#39;His&#39;, &#39;dedication&#39;, &#39;to&#39;, &#39;composition&#39;, &#39;and&#39;, &#39;miseenscene&#39;, &#39;is&#39;, &#39;unrivalled&#39;, &#39;not&#39;, &#39;to&#39;, &#39;mention&#39;, &#39;his&#39;, &#39;use&#39;, &#39;of&#39;, &#39;sound&#39;, &#39;and&#39;, &#39;production&#39;, &#39;design&#39;, &#39;But&#39;, &#39;since&#39;, &#39;his&#39;, &#39;nofrills&#39;, &#39;melodramas&#39;, &#39;turned&#39;, &#39;out&#39;, &#39;to&#39;, &#39;be&#39;, &#39;Breaking&#39;, &#39;the&#39;, &#39;Waves&#39;, &#39;and&#39;, &#39;Dancer&#39;, &#39;in&#39;, &#39;the&#39;, &#39;Dark&#39;, &#39;then&#39;, &#39;who&#39;, &#39;can&#39;, &#39;argue&#39;, &#39;but&#39;, &#39;it&#39;, &#39;does&#39;, &#39;seems&#39;, &#39;like&#39;, &#39;a&#39;, &#39;waste&#39;, &#39;of&#39;, &#39;an&#39;, &#39;imaginative&#39;, &#39;talent&#39;, &#39;1010&#39;]}
</pre></div>
</div>
</div>
</div>
<section id="convert-to-pandas-dataframe">
<h3>Convert to Pandas DataFrame<a class="headerlink" href="#convert-to-pandas-dataframe" title="Link to this heading">#</a></h3>
<p>Converting the processed Ray Dataset to a Pandas DataFrame for further analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a tokenized Pandas DataFrame from the &#39;joined&#39; Ray Dataset</span>
<span class="c1"># Note: This will convert the Ray Dataset to a Pandas DataFrame, which may not</span>
<span class="c1"># be suitable for very large datasets due to memory constraints.</span>
<span class="n">preprocessed_df</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">joined</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e49e64975f844f35a83c00c4504ecbf7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3a91fb451c66436eac7fa15ab676b30f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "186e973505114de496a096dc906ade0d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a807095d9505438fa60146b2c71c206c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the first few rows of the preprocessed DataFrame</span>
<span class="n">preprocessed_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>text</th>
      <th>label</th>
      <th>source</th>
      <th>text_tokenized</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12500</td>
      <td>Zentropa has much in common with The Third Man...</td>
      <td>1</td>
      <td>imdb</td>
      <td>[Zentropa, has, much, in, common, with, The, T...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13000</td>
      <td>Visually stunning and full of Eastern Philosop...</td>
      <td>1</td>
      <td>imdb</td>
      <td>[Visually, stunning, and, full, of, Eastern, P...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13100</td>
      <td>The fourth of five westerns Anthony Mann did w...</td>
      <td>1</td>
      <td>imdb</td>
      <td>[The, fourth, of, five, westerns, Anthony, Man...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13600</td>
      <td>I miss Dark Angel!..&lt;br /&gt;&lt;br /&gt;I understand n...</td>
      <td>1</td>
      <td>imdb</td>
      <td>[I, miss, Dark, Angelbr, br, I, understand, no...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13700</td>
      <td>I like the good and evil battle. I liked Eddie...</td>
      <td>1</td>
      <td>imdb</td>
      <td>[I, like, the, good, and, evil, battle, I, lik...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="shutdown-ray">
<h3>Shutdown Ray<a class="headerlink" href="#shutdown-ray" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shutdown Ray</span>
<span class="n">ray</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h3>
<p>This notebook demonstrates how to preprocess large datasets using Ray Data in a distributed and scalable way. It covers loading a public dataset (IMDB reviews), converting it to a Ray Dataset, filtering and joining data, applying tokenization, and converting the results to a Pandas DataFrame for further analysis. The workflow highlights how Ray Data enables efficient data processing for machine learning pipelines, even with datasets that are too large for a single machine.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./courses/WL_Ray_Data_Processing"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outline-of-the-notebook">Outline of the notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#library-imports">Library Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-ray-and-load-a-dataset">Initialize Ray and Load a Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-to-ray-dataset">Convert to Ray Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-second-dataset">Create a Second Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-ray-dataset">Filter Ray Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#join-two-ray-datasets">Join Two Ray Datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-with-a-tokenizer">Preprocessing with a Tokenizer</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-to-pandas-dataframe">Convert to Pandas DataFrame</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shutdown-ray">Shutdown Ray</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>